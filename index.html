<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Futures Trading Calculator</title>
    <style>
        /* General Reset & Typography */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
            background: linear-gradient(135deg, #e8eef5 0%, #d4e4f7 50%, #c8daf3 100%);
            color: #1e293b;
            line-height: 1.6;
            padding: 10px;
            min-height: 100vh;
            overflow-x: hidden;
            width: 100%;
            max-width: 100vw;
        }

        /* Header Section */
        .header {
            text-align: center;
            padding: 20px 10px 30px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            font-weight: 800;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            letter-spacing: -0.02em;
        }

        .header p {
            font-size: clamp(0.85rem, 2.5vw, 1rem);
            color: #64748b;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }

        /* Instructions Panel */
        .instructions {
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
            border-left: 4px solid #3b82f6;
        }

        .instructions h3 {
            font-size: clamp(1rem, 3vw, 1.2rem);
            color: #1e40af;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .instructions ul {
            list-style: none;
            padding: 0;
        }

        .instructions li {
            font-size: clamp(0.8rem, 2.5vw, 0.9rem);
            color: #475569;
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
            line-height: 1.5;
        }

        .instructions li:before {
            content: "â†’";
            position: absolute;
            left: 0;
            color: #3b82f6;
            font-weight: bold;
        }

        /* Container and Layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            gap: 15px;
            grid-template-columns: 1fr;
            width: 100%;
        }

        /* Desktop Layout */
        @media (min-width: 1024px) {
            body {
                padding: 20px;
            }
            
            .container {
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: auto auto auto 1fr;
                gap: 20px;
            }
            
            .header {
                grid-column: 1 / 4;
                grid-row: 1 / 2;
            }
            
            .instructions {
                grid-column: 1 / 4;
                grid-row: 2 / 3;
            }
            
            .instrument-section {
                grid-column: 1 / 2;
                grid-row: 3 / 4;
            }
            .risk-calculator {
                grid-column: 2 / 3;
                grid-row: 3 / 4;
            }
            .pnl-calculator {
                grid-column: 3 / 4;
                grid-row: 3 / 4;
            }
            .journal-section {
                grid-column: 1 / 4;
                grid-row: 4 / 5;
            }
            .disclaimer-section {
                grid-column: 1 / 4;
                grid-row: 5 / 6;
            }
        }

        /* Cards/Panels */
        .card {
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 100%);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
            border: 1px solid rgba(59, 130, 246, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            overflow: hidden;
        }

        @media (min-width: 768px) {
            .card {
                padding: 20px;
            }
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }

        h2 {
            font-size: clamp(1.1rem, 3vw, 1.5rem);
            margin-bottom: 15px;
            color: #1e40af;
            border-bottom: 2px solid #dbeafe;
            padding-bottom: 8px;
            font-weight: 700;
        }

        h3 {
            font-size: clamp(0.95rem, 2.5vw, 1.2rem);
            margin-top: 15px;
            color: #1e40af;
            border-bottom: 1px solid #dbeafe;
            padding-bottom: 5px;
        }

        /* Input Styles */
        .input-group {
            margin-bottom: 12px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: clamp(0.8rem, 2.5vw, 0.9rem);
            color: #475569;
            font-weight: 600;
        }

        input[type="number"], input[type="text"], select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #cbd5e1;
            background-color: #ffffff;
            color: #1e293b;
            font-size: clamp(0.85rem, 2.5vw, 1rem);
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        input[type="number"]:focus, input[type="text"]:focus, select:focus {
            border-color: #3b82f6;
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        /* Output Display */
        .output-panel {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
        }

        .output-panel p {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: clamp(0.8rem, 2.5vw, 0.95rem);
            flex-wrap: wrap;
            gap: 5px;
        }

        .output-panel p strong {
            color: #0c4a6e;
            font-weight: 700;
        }

        .output-panel p.highlight strong {
            color: #1e40af;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
        }

        /* Button Styles */
        .button-group {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            font-size: clamp(0.8rem, 2.5vw, 0.9rem);
            flex: 1 1 auto;
            min-width: fit-content;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: #ffffff;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .btn-secondary {
            background-color: #e2e8f0;
            color: #334155;
            border: 1px solid #cbd5e1;
        }

        .btn-secondary:hover {
            background-color: #cbd5e1;
        }

        /* Trade Journal Table */
        .journal-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin-top: 15px;
        }

        .journal-table {
            width: 100%;
            min-width: 800px;
            border-collapse: collapse;
            font-size: clamp(0.75rem, 2vw, 0.85rem);
        }

        .journal-table th, .journal-table td {
            padding: 10px 8px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
            white-space: nowrap;
        }

        .journal-table th {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: #1e40af;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .journal-table tbody tr:hover {
            background-color: #f1f5f9;
        }

        .summary-row td {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            font-weight: bold;
            color: #0c4a6e;
            border-top: 2px solid #3b82f6;
        }

        /* Disclaimers */
        .disclaimer-section {
            margin-top: 20px;
            padding: 15px;
            border-top: 1px solid #cbd5e1;
            font-size: clamp(0.7rem, 2vw, 0.75rem);
            color: #64748b;
            background: linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0.6) 100%);
            border-radius: 12px;
        }

        .disclaimer-section p {
            margin-bottom: 12px;
            line-height: 1.5;
        }

        .disclaimer-section hr {
            border: 0;
            height: 1px;
            background-color: #cbd5e1;
            margin: 12px 0;
        }

        /* Responsive text wrapping */
        @media (max-width: 767px) {
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

    </style>
</head>
<body>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Futures Trading Calculator</h1>
            <p>Professional risk management and P&L calculator for futures traders</p>
        </div>

        <!-- Instructions -->
        <div class="instructions">
            <h3>ðŸ“‹ How to Use This Tool</h3>
            <ul>
                <li><strong>Instrument & Margin:</strong> Select your trading instrument (ES, NQ, etc.) or add a custom one. View tick size, tick value, and margin requirements.</li>
                <li><strong>Position Size & Risk:</strong> Enter your account balance, risk percentage, and stop loss in ticks. The calculator shows max contracts you can trade within your risk limits.</li>
                <li><strong>P&L & Simulation:</strong> Input entry/exit prices and contract quantity. Optionally add target and stop prices to calculate risk-to-reward ratio.</li>
                <li><strong>Trade Journal:</strong> Click "Add Trade to Journal" to log trades. Export your data in CSV, TXT, JSON, or PDF formats for analysis.</li>
                <li><strong>Note:</strong> All data is stored locally in your browser. Refresh or close the page to clear all session data.</li>
            </ul>
        </div>

        <!-- Instrument Selector and Specs -->
        <section class="card instrument-section">
            <h2>Instrument & Margin</h2>
            <div class="input-group">
                <label for="instrument-select">Select Instrument</label>
                <select id="instrument-select"></select>
            </div>

            <div class="output-panel">
                <p>Exchange: <strong id="spec-exchange">N/A</strong></p>
                <p>Tick Size: <strong id="spec-tick-size">N/A</strong></p>
                <p>Tick Value: <strong id="spec-tick-value">N/A</strong></p>
                <p>Point Value: <strong id="spec-point-value">N/A</strong></p>
                <p class="highlight">Margin/Contract: <strong id="spec-margin">N/A</strong></p>
                <p>Leverage: <strong id="output-leverage">0x</strong></p>
            </div>

            <h3>Custom Instrument</h3>
            <div id="custom-instrument-form">
                <div class="input-group"><input type="text" id="custom-name" placeholder="Name (e.g., CUS)"></div>
                <div class="input-group"><input type="number" id="custom-tick-size" placeholder="Tick Size (e.g., 0.25)" step="any"></div>
                <div class="input-group"><input type="number" id="custom-tick-value" placeholder="Tick Value (e.g., 12.50)" step="any"></div>
                <div class="input-group"><input type="number" id="custom-multiplier" placeholder="Point Value (Multiplier)" step="any"></div>
                <div class="input-group"><input type="number" id="custom-margin" placeholder="Margin (e.g., 12000)" step="any"></div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="addCustomInstrument()">Add Custom</button>
                </div>
            </div>

        </section>

        <!-- Position Size & Risk Calculator -->
        <section class="card risk-calculator">
            <h2>Position Size & Risk</h2>
            <div class="input-group">
                <label for="account-balance">Account Balance ($)</label>
                <input type="number" id="account-balance" value="25000" min="0" step="100" oninput="updateCalculators()">
            </div>
            <div class="input-group">
                <label for="risk-percent">Risk Percentage (%)</label>
                <input type="number" id="risk-percent" value="1.0" min="0.01" max="100" step="0.1" oninput="updateCalculators()">
            </div>
            <div class="input-group">
                <label for="stop-ticks">Stop Loss (Ticks)</label>
                <input type="number" id="stop-ticks" value="16" min="1" step="1" oninput="updateCalculators()">
            </div>

            <div class="output-panel">
                <p>Dollar Risk/Trade: <strong id="output-dollar-risk">$0.00</strong></p>
                <p>Stop Loss (Points): <strong id="output-point-risk">0.00</strong></p>
                <p>Stop Loss (Ticks): <strong id="output-tick-risk">0</strong></p>
                <p class="highlight">Max Contracts: <strong id="output-max-contracts">0</strong></p>
            </div>
        </section>

        <!-- P&L and Simulation Calculator -->
        <section class="card pnl-calculator">
            <h2>P&L & Simulation</h2>
            <div class="input-group">
                <label for="entry-price">Entry Price</label>
                <input type="number" id="entry-price" value="4500.00" step="any" oninput="updateCalculators()">
            </div>
            <div class="input-group">
                <label for="exit-price">Exit Price</label>
                <input type="number" id="exit-price" value="4510.00" step="any" oninput="updateCalculators()">
            </div>
            <div class="input-group">
                <label for="num-contracts">Number of Contracts</label>
                <input type="number" id="num-contracts" value="1" min="1" step="1" oninput="updateCalculators()">
            </div>
            <div class="input-group">
                <label for="commission">Commission (per contract, round trip)</label>
                <input type="number" id="commission" value="4.00" min="0" step="0.01" oninput="updateCalculators()">
            </div>

            <h3>Trade Outcomes</h3>
            <div class="input-group">
                <label for="target-price">Target Price (Optional)</label>
                <input type="number" id="target-price" value="4520.00" step="any" oninput="updateCalculators()">
            </div>
            <div class="input-group">
                <label for="stop-price">Stop Price (Optional)</label>
                <input type="number" id="stop-price" value="4495.00" step="any" oninput="updateCalculators()">
            </div>


            <div class="output-panel">
                <p>Gross P&L ($): <strong id="output-gross-pnl">$0.00</strong></p>
                <p>Net P&L ($): <strong id="output-net-pnl">$0.00</strong></p>
                <p>P&L (Points): <strong id="output-pnl-points">0.00</strong></p>
                <p>P&L (Ticks): <strong id="output-pnl-ticks">0</strong></p>
                <hr style="border: 0; height: 1px; background-color: #cbd5e1; margin: 10px 0;">
                <p class="highlight">Risk-to-Reward (R:R): <strong id="output-rr">0.00:1</strong></p>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="addTradeToJournal()">Add Trade to Journal</button>
            </div>
        </section>

        <!-- Trade Journal -->
        <section class="card journal-section">
            <h2>Trade Journal (Session Data)</h2>
            <div class="button-group">
                <button class="btn btn-secondary" onclick="exportJournal('csv')">Export CSV</button>
                <button class="btn btn-secondary" onclick="exportJournal('txt')">Export TXT</button>
                <button class="btn btn-secondary" onclick="exportJournal('json')">Export JSON</button>
                <button class="btn btn-secondary" onclick="exportJournal('pdf')">Export PDF</button>
                <button class="btn btn-secondary" onclick="clearJournal()">Clear Journal</button>
                <button class="btn btn-secondary" onclick="resetAll()">Reset All</button>
            </div>

            <div class="journal-container">
                <table class="journal-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Instrument</th>
                            <th>Qty</th>
                            <th>Entry</th>
                            <th>Exit</th>
                            <th>Stop</th>
                            <th>Target</th>
                            <th>R:R</th>
                            <th>Net P&L ($)</th>
                            <th>Comms ($)</th>
                        </tr>
                    </thead>
                    <tbody id="journal-body">
                        <!-- Trades will be inserted here -->
                    </tbody>
                    <tfoot>
                        <tr class="summary-row">
                            <td colspan="7">TOTALS/AVERAGE</td>
                            <td id="summary-avg-rr">Avg R:R: 0.00</td>
                            <td id="summary-total-pnl">Total P&L: $0.00</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </section>

        <!-- Disclaimers -->
        <section class="disclaimer-section">
            <p>HYPOTHETICAL OR SIMULATED PERFORMANCE RESULTS HAVE CERTAIN INHERENT LIMITATIONS. UNLIKE AN ACTUAL PERFORMANCE RECORD, SIMULATED RESULTS DO NOT REPRESENT ACTUAL TRADING. ALSO, SINCE THE TRADES HAVE NOT BEEN EXECUTED, THE RESULTS MAY HAVE UNDER-OR-OVER COMPENSATED FOR THE IMPACT, IF ANY, OF CERTAIN MARKET FACTORS, SUCH AS LACK OF LIQUIDITY. SIMULATED TRADING PROGRAMS IN GENERAL ARE ALSO SUBJECT TO THE FACT THAT THEY ARE DESIGNED WITH THE BENEFIT OF HINDSIGHT. NO REPRESENTATION IS BEING MADE THAT ANY ACCOUNT WILL OR IS LIKELY TO ACHIEVE PROFIT OR LOSSES SIMILAR TO THOSE SHOWN.</p>
            <hr>
            <p>All calculations and trade data exist only in your browser's memory. Nothing is saved or transmitted. Refreshing or closing the page will permanently clear all data. This website does not provide financial, investment, or trading advice. Use of any information or tools on this site is entirely at your own risk.</p>
        </section>

    </div>

    <script>
        const BUILT_IN_INSTRUMENTS = {
            'ES': { tickSize: 0.25, tickValue: 12.50, contractMultiplier: 50, margin: 12000, exchange: 'CME' },
            'MES': { tickSize: 0.25, tickValue: 1.25, contractMultiplier: 5, margin: 1200, exchange: 'CME' },
            'NQ': { tickSize: 0.25, tickValue: 5.00, contractMultiplier: 20, margin: 15000, exchange: 'CME' },
            'MNQ': { tickSize: 0.25, tickValue: 0.50, contractMultiplier: 2, margin: 1500, exchange: 'CME' },
            'YM': { tickSize: 1.00, tickValue: 5.00, contractMultiplier: 5, margin: 5000, exchange: 'CBOT' },
            'MYM': { tickSize: 1.00, tickValue: 0.50, contractMultiplier: 0.5, margin: 500, exchange: 'CBOT' },
            'RTY': { tickSize: 0.10, tickValue: 5.00, contractMultiplier: 10, margin: 7500, exchange: 'CME' },
            'M2K': { tickSize: 0.10, tickValue: 0.50, contractMultiplier: 1, margin: 750, exchange: 'CME' },
            'GC': { tickSize: 0.10, tickValue: 10.00, contractMultiplier: 100, margin: 8000, exchange: 'COMEX' },
            'MGC': { tickSize: 0.10, tickValue: 1.00, contractMultiplier: 10, margin: 800, exchange: 'COMEX' },
            'SI': { tickSize: 0.005, tickValue: 25.00, contractMultiplier: 5000, margin: 10000, exchange: 'COMEX' },
            'SIL': { tickSize: 0.005, tickValue: 5.00, contractMultiplier: 1000, margin: 2000, exchange: 'COMEX' },
            'CL': { tickSize: 0.01, tickValue: 10.00, contractMultiplier: 1000, margin: 11000, exchange: 'NYMEX' },
            'MCL': { tickSize: 0.01, tickValue: 1.00, contractMultiplier: 100, margin: 1100, exchange: 'NYMEX' },
            'NG': { tickSize: 0.001, tickValue: 10.00, contractMultiplier: 10000, margin: 4000, exchange: 'NYMEX' },
            'ZB': { tickSize: 0.01, tickValue: 31.25, contractMultiplier: 1000, margin: 2500, exchange: 'CBOT' },
            '6E': { tickSize: 0.00005, tickValue: 6.25, contractMultiplier: 125000, margin: 1500, exchange: 'CME' }
        };

        let currentInstruments = {...BUILT_IN_INSTRUMENTS};
        let tradeJournal = [];

        function initInstrumentSelector() {
            const select = document.getElementById('instrument-select');
            select.innerHTML = '';
            const allSymbols = Object.keys(currentInstruments).sort();

            allSymbols.forEach(symbol => {
                const option = document.createElement('option');
                option.value = symbol;
                option.textContent = symbol;
                select.appendChild(option);
            });

            select.onchange = updateCalculators;
            select.value = 'ES';
            updateCalculators();
        }

        function getInstrument() {
            const selectedSymbol = document.getElementById('instrument-select').value;
            return currentInstruments[selectedSymbol];
        }

        function updateInstrumentSpecs(inst) {
            if (!inst) {
                document.getElementById('spec-exchange').textContent = 'N/A';
                document.getElementById('spec-tick-size').textContent = 'N/A';
                document.getElementById('spec-tick-value').textContent = 'N/A';
                document.getElementById('spec-point-value').textContent = 'N/A';
                document.getElementById('spec-margin').textContent = 'N/A';
                return;
            }

            document.getElementById('spec-exchange').textContent = inst.exchange || 'N/A';
            document.getElementById('spec-tick-size').textContent = inst.tickSize.toFixed(Math.max(2, inst.tickSize.toString().split('.')[1]?.length || 0));
            document.getElementById('spec-tick-value').textContent = `$${inst.tickValue.toFixed(2)}`;
            document.getElementById('spec-point-value').textContent = `$${inst.contractMultiplier.toFixed(2)}`;
            document.getElementById('spec-margin').textContent = `$${inst.margin.toLocaleString()}`;
        }

        function addCustomInstrument() {
            const name = document.getElementById('custom-name').value.toUpperCase().trim();
            const tickSize = parseFloat(document.getElementById('custom-tick-size').value);
            const tickValue = parseFloat(document.getElementById('custom-tick-value').value);
            const multiplier = parseFloat(document.getElementById('custom-multiplier').value);
            const margin = parseFloat(document.getElementById('custom-margin').value);

            if (!name || isNaN(tickSize) || isNaN(tickValue) || isNaN(multiplier) || isNaN(margin) || tickSize <= 0 || tickValue <= 0 || multiplier <= 0 || margin <= 0) {
                alert('Please enter valid, positive values for all custom instrument fields.');
                return;
            }

            currentInstruments[name] = {
                tickSize: tickSize,
                tickValue: tickValue,
                contractMultiplier: multiplier,
                margin: margin,
                exchange: 'CUSTOM'
            };

            initInstrumentSelector();
            document.getElementById('instrument-select').value = name;
            updateCalculators();

            document.getElementById('custom-name').value = '';
            document.getElementById('custom-tick-size').value = '';
            document.getElementById('custom-tick-value').value = '';
            document.getElementById('custom-multiplier').value = '';
            document.getElementById('custom-margin').value = '';
        }

        function calculatePositionAndRisk(inst) {
            const balance = parseFloat(document.getElementById('account-balance').value);
            const riskPercent = parseFloat(document.getElementById('risk-percent').value);
            const stopTicks = parseFloat(document.getElementById('stop-ticks').value);

            if (!inst || isNaN(balance) || isNaN(riskPercent) || isNaN(stopTicks) || balance <= 0 || riskPercent <= 0 || stopTicks <= 0) {
                document.getElementById('output-dollar-risk').textContent = '$0.00';
                document.getElementById('output-point-risk').textContent = '0.00';
                document.getElementById('output-tick-risk').textContent = '0';
                document.getElementById('output-max-contracts').textContent = '0';
                return { dollarRisk: 0, maxContracts: 0, pointRisk: 0 };
            }

            const dollarRiskPerContract = stopTicks * inst.tickValue;
            const maxDollarRisk = balance * (riskPercent / 100);
            const maxContracts = dollarRiskPerContract > 0 ? Math.floor(maxDollarRisk / dollarRiskPerContract
